set(PROTO_SRCS_DIR "${CMAKE_CURRENT_SOURCE_DIR}")

set(PROTOC_EXECUTABLE ${CMAKE_HOME_DIRECTORY}/3rdparty/protobuf_lib/protoc.exe)

set(GENERATED_PROTO_SRCS_DIR "${CMAKE_CURRENT_SOURCE_DIR}")

set(PROTO_OUTPUT_DIR ${CMAKE_HOME_DIRECTORY}/Proto)

set(PROTO_FILES ${PROTO_OUTPUT_DIR}/RDPBoost.proto)

message("PROTO_SRCS_DIR: ${PROTO_SRCS_DIR}")
message("PROTOC_EXECUTABLE: ${PROTOC_EXECUTABLE}")
message("GENERATED_PROTO_SRCS_DIR: ${GENERATED_PROTO_SRCS_DIR}")

set(PROTO_OUTPUT_DIR ${CMAKE_HOME_DIRECTORY}/Proto)

message("PROTO_OUTPUT_DIR: ${PROTO_OUTPUT_DIR}")
# 将生成的文件复制到主目录
#file(MAKE_DIRECTORY ${PROTO_OUTPUT_DIR})

add_custom_command(
    OUTPUT ${PROTO_OUTPUT_DIR}
    COMMAND ${PROTOC_EXECUTABLE}
    ARGS --proto_path=${PROTO_OUTPUT_DIR}
    ARGS ${PROTO_FILES}
    ARGS --cpp_out=${PROTO_OUTPUT_DIR}
    DEPENDS ${PROTO_FILES}
    COMMENT "Generating proto file "
)

add_custom_target(protocgen ALL DEPENDS ${PROTO_OUTPUT_DIR})

